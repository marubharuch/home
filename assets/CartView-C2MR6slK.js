import{r as d,j as e,l as m}from"./index-Dig7gZbR.js";function I({orderKey:f,onSave:p,onModify:j}){const[o,x]=d.useState({}),[u,b]=d.useState(0),[i,h]=d.useState({orderNo:"",createdAt:""});d.useEffect(()=>{(async()=>{const r=await m.getItem("cart")||{};let a=r._orderInfo;if(!a){const s=/^\d{10}$/.test(f)?f:null;let n=1;if(s){const N=await m.getItem("orders")||{};n=(Object.keys(N).filter(l=>l.startsWith(s)).map(l=>parseInt(l.split("/")[1]||"0")).sort((l,y)=>y-l)[0]||0)+1}a={orderNo:s?`${s}/${n}`:`TEMP/${Date.now()}`,createdAt:new Date().toLocaleString()},r._orderInfo=a,await m.setItem("cart",r)}h(a);const c=Object.entries(r).filter(([s])=>s!=="_orderInfo").reduce((s,[,n])=>s+(parseFloat(n.finalPrice)||0)*(n.quantity||0),0);b(c),x(r)})()},[f]);const g=async()=>{window.confirm("Clear all items from the cart?")&&(await m.setItem("cart",{}),x({}),b(0),h({orderNo:"",createdAt:""}),window.dispatchEvent(new Event("cartUpdated")))};return e.jsxs("div",{className:"p-4",children:[console.log(i),i.orderNo&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-100 border rounded",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["ðŸ§¾ Order No: ",i.orderNo]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["ðŸ“… ",i.createdAt]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"ðŸ›’ Cart"}),e.jsx("button",{onClick:g,className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Clear Cart"})]}),Object.keys(o).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length===0?e.jsx("p",{className:"text-gray-500",children:"Cart is empty"}):Object.entries(o).filter(([t])=>t!=="_orderInfo"&&t!=="_mobile").map(([t,r])=>e.jsxs("div",{className:"border-b py-2",children:[e.jsx("div",{className:"mb-1",children:Object.entries(r).map(([a,c])=>{const s=a.toLowerCase();return["code","particulars","description","name"].includes(s)?e.jsx("span",{className:"mr-2 font-semibold",children:s==="code"?`[${c}]`:c},a):null})}),e.jsxs("div",{className:"text-right",children:["Qty: ",r.quantity," Ã— â‚¹",r.finalPrice," ="," ",e.jsxs("span",{className:"font-bold",children:["â‚¹",(r.quantity*parseFloat(r.finalPrice)).toFixed(2)]})]})]},t)),Object.keys(o).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between items-center mt-4 p-2 border-t",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-green-700",children:["â‚¹",u.toFixed(2)]})]}),Object.keys(o).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("button",{onClick:j,className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Modify"}),e.jsx("button",{onClick:()=>p(o),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Save Order"})]})]})}export{I as default};
