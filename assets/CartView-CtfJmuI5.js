import{r as i,l as d,j as t}from"./index-8v5MRu7-.js";import{l as N}from"./lodash-CNBtuFgo.js";function v({orderKey:n,onSave:m,onModify:f}){const[l,c]=i.useState({}),[r,x]=i.useState(null);i.useEffect(()=>{(async()=>{if(n&&n!=="NEW"){const e=await d.getItem("orders")||{};e[n]&&c(e[n].cart||{})}else{const e=await d.getItem("cartDraft");e&&c(e)}})()},[n]);const p=N.debounce(async e=>{await d.setItem("cartDraft",e)},300);i.useEffect(()=>{n==="NEW"&&p(l)},[l,n]);const u=(e,s)=>{c(o=>{const a={...o};return a[e].quantity=Math.max(0,(a[e].quantity||0)+s),a[e].quantity===0&&delete a[e],a})},h=e=>{const s=l[e];x({key:e,item:s}),c(o=>{const a={...o};return delete a[e],a})},j=()=>{r&&(c(e=>({...e,[r.key]:r.item})),x(null))},b=Object.values(l).reduce((e,s)=>e+(parseFloat(s.finalPrice)||0)*(s.quantity||0),0),g=async()=>{await d.removeItem("cartDraft"),m(l)};return t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsx("h2",{className:"text-xl font-bold",children:"ğŸ›’ Cart"}),Object.keys(l).length===0?t.jsx("p",{className:"text-gray-500",children:"Your cart is empty."}):t.jsx("ul",{className:"space-y-2",children:Object.entries(l).map(([e,s])=>t.jsxs("li",{className:"flex justify-between items-center border p-2 rounded",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:s.name}),t.jsxs("p",{className:"text-sm text-gray-600",children:["â‚¹",s.finalPrice]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:"px-2 py-1 bg-gray-300 rounded",onClick:()=>u(e,-1),children:"â–"}),t.jsx("span",{children:s.quantity}),t.jsx("button",{className:"px-2 py-1 bg-gray-300 rounded",onClick:()=>u(e,1),children:"â•"}),t.jsx("button",{className:"px-2 py-1 bg-red-500 text-white rounded ml-2",onClick:()=>h(e),children:"ğŸ—‘ï¸"})]})]},e))}),r&&t.jsxs("div",{className:"bg-yellow-100 p-2 rounded flex justify-between items-center",children:[t.jsx("span",{children:"Item deleted"}),t.jsx("button",{className:"text-blue-600 underline",onClick:j,children:"Undo"})]}),t.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t p-4 flex justify-between items-center",children:[t.jsxs("span",{className:"text-lg font-bold",children:["Total: â‚¹",b.toFixed(2)]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"px-4 py-2 bg-gray-400 text-white rounded",onClick:f,children:"ğŸ”™ Back"}),t.jsx("button",{className:"px-4 py-2 bg-green-600 text-white rounded",onClick:g,children:"ğŸ’¾ Save"})]})]})]})}export{v as default};
