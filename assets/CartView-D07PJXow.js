import{r as o,j as a,a as x,l as f,s as g,b as j}from"./index-BAQreQ81.js";function N({orderKey:n,selectedOrder:l}){const[c,i]=o.useState({}),[m,d]=o.useState(0),[r,p]=o.useState("");o.useEffect(()=>{(async()=>{if(n&&l)i(l.cart||{}),d(x(l.cart||{})),p(l.mobile||"");else{const e=await f.getItem("cart")||{};i(e),d(x(e)),e._orderInfo?.mobile&&p(e._orderInfo.mobile)}})()},[n,l]);const b=async()=>{if(!r){alert("Please enter mobile number before saving");return}const s={cart:c,mobile:r,createdAt:l?.createdAt};try{const e=await g(n,s);console.log("Order saved:",e,s),alert(`âœ… Order saved successfully (${e})`),await j(),i({}),d(0)}catch(e){alert(e.message||"Error saving order")}},u=()=>{if(!r){alert("Please enter mobile number before sending");return}const s=Object.values(c).filter(t=>t&&t.name).map(t=>`${t.name} - â‚¹${t.finalPrice} Ã— ${t.quantity}`).join(`
`),e=`https://wa.me/91${r}?text=${encodeURIComponent(s)}`;console.log("Opening WhatsApp:",e),window.open(e,"_blank")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"ðŸ›’ Your Cart"}),n&&a.jsxs("div",{className:"bg-yellow-100 text-yellow-800 p-2 rounded",children:[a.jsx("strong",{children:"Order No:"})," ",n]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:"Mobile Number:"}),a.jsx("input",{type:"text",value:r,onChange:s=>{const e=s.target.value.replace(/\D/g,"");e.length<=10&&p(e)},placeholder:"10-digit number",className:"border px-2 py-1 rounded w-full"})]}),a.jsx("div",{className:"space-y-2",children:Object.entries(c).filter(([s])=>s!=="_orderInfo"&&s!=="_mobile").map(([s,e])=>a.jsxs("div",{className:"border-b py-2",children:[a.jsx("div",{className:"text-sm space-y-1",children:Object.entries(e).map(([t,h])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("span",{className:"font-semibold",children:[t,":"]}),a.jsx("span",{children:h?.toString()})]},t))}),a.jsxs("div",{className:"text-right mt-1",children:["Qty: ",e.quantity," Ã— â‚¹",e.finalPrice," ="," ",a.jsxs("span",{className:"font-bold",children:["â‚¹",(e.quantity*parseFloat(e.finalPrice)).toFixed(2)]})]})]},s))}),a.jsxs("div",{className:"font-bold",children:["Total: â‚¹",m.toFixed(2)]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"ðŸ’¾ Save Order"}),a.jsx("button",{onClick:u,className:"px-4 py-2 bg-green-600 text-white rounded",children:"ðŸ“² Send via WhatsApp"})]})]})}export{N as default};
