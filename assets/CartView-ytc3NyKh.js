import{r as c,j as e,l as d}from"./index-DkiZcOWU.js";function I({orderKey:m,onSave:p,onModify:j}){const[n,x]=c.useState({}),[u,b]=c.useState(0),[f,h]=c.useState({orderNo:"",createdAt:""});c.useEffect(()=>{(async()=>{const r=await d.getItem("cart")||{};let a=r._orderInfo;if(!a){const s=/^\d{10}$/.test(m)?m:null;let o=1;if(s){const N=await d.getItem("orders")||{};o=(Object.keys(N).filter(l=>l.startsWith(s)).map(l=>parseInt(l.split("/")[1]||"0")).sort((l,y)=>y-l)[0]||0)+1}a={orderNo:s?`${s}/${o}`:`TEMP/${Date.now()}`,createdAt:new Date().toLocaleString()},r._orderInfo=a,await d.setItem("cart",r)}h(a);const i=Object.entries(r).filter(([s])=>s!=="_orderInfo").reduce((s,[,o])=>s+(parseFloat(o.finalPrice)||0)*(o.quantity||0),0);b(i),x(r)})()},[m]);const g=async()=>{window.confirm("Clear all items from the cart?")&&(await d.setItem("cart",{}),x({}),b(0),h({orderNo:"",createdAt:""}),window.dispatchEvent(new Event("cartUpdated")))};return e.jsxs("div",{className:"p-4",children:[f.orderNo&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-100 border rounded",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["ðŸ§¾ Order No: ",f.orderNo]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["ðŸ“… ",f.createdAt]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"ðŸ›’ Cart"}),e.jsx("button",{onClick:g,className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Clear Cart"})]}),Object.keys(n).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length===0?e.jsx("p",{className:"text-gray-500",children:"Cart is empty"}):Object.entries(n).filter(([t])=>t!=="_orderInfo"&&t!=="_mobile").map(([t,r])=>e.jsxs("div",{className:"border-b py-2",children:[e.jsx("div",{className:"mb-1",children:Object.entries(r).map(([a,i])=>{const s=a.toLowerCase();return["code","particulars","description","name"].includes(s)?e.jsx("span",{className:"mr-2 font-semibold",children:s==="code"?`[${i}]`:i},a):null})}),e.jsxs("div",{className:"text-right",children:["Qty: ",r.quantity," Ã— â‚¹",r.finalPrice," ="," ",e.jsxs("span",{className:"font-bold",children:["â‚¹",(r.quantity*parseFloat(r.finalPrice)).toFixed(2)]})]})]},t)),Object.keys(n).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between items-center mt-4 p-2 border-t",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-green-700",children:["â‚¹",u.toFixed(2)]})]}),Object.keys(n).filter(t=>t!=="_orderInfo"&&t!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("button",{onClick:j,className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Modify"}),e.jsx("button",{onClick:()=>p(n),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Save Order"})]})]})}export{I as default};
