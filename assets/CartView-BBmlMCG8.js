import{r as o,j as n,l as i,a as u,s as f,b as g}from"./index-Dcy8-TVp.js";function j({orderKey:p}){const[s,l]=o.useState({}),[m,c]=o.useState(0),[r,d]=o.useState("");o.useEffect(()=>{(async()=>{const t=await i.getItem("cart")||{};l(t),c(u(t)),t._orderInfo?.mobile&&d(t._orderInfo.mobile)})()},[]);const b=async(e,t)=>{const a={...s,[e]:{...s[e],quantity:t}};l(a),c(u(a)),await i.setItem("cart",a),window.dispatchEvent(new Event("cartUpdated")),console.log(`Quantity changed for item ${e}: ${t}`)},x=async()=>{if(!r){alert("Please enter mobile number before saving");return}const e=new Date,t={cart:s,mobile:r,createdAt:e.toISOString()},a=p||e.getTime().toString();await f(a,t),console.log("Order saved:",a,t),alert(`âœ… Order saved successfully (${a})`),await g(),l({}),c(0)},h=()=>{if(!r){alert("Please enter mobile number before sending");return}const e=Object.values(s).filter(a=>a&&a.name).map(a=>`${a.name} - â‚¹${a.finalPrice} Ã— ${a.quantity}`).join(`
`),t=`https://wa.me/91${r}?text=${encodeURIComponent(e)}`;console.log("Opening WhatsApp:",t),window.open(t,"_blank")};return n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsx("h2",{className:"text-lg font-bold",children:"ðŸ›’ Your Cart"}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1",children:"Mobile Number:"}),n.jsx("input",{type:"text",value:r,onChange:e=>d(e.target.value.replace(/\D/g,"")),placeholder:"10-digit number",className:"border px-2 py-1 rounded w-full"})]}),n.jsx("div",{className:"space-y-2",children:Object.entries(s).filter(([e])=>e!=="_orderInfo").map(([e,t])=>n.jsxs("div",{className:"flex justify-between items-center border p-2 rounded",children:[n.jsx("span",{children:t.name}),n.jsx("input",{type:"number",value:t.quantity,onChange:a=>b(e,parseInt(a.target.value)),className:"w-16 border rounded px-1",min:"1"})]},e))}),n.jsxs("div",{className:"font-bold",children:["Total: â‚¹",m.toFixed(2)]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:x,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"ðŸ’¾ Save Order"}),n.jsx("button",{onClick:h,className:"px-4 py-2 bg-green-600 text-white rounded",children:"ðŸ“² Send via WhatsApp"})]})]})}export{j as default};
