import{r as l,j as a,a as m,l as h,g,s as j,b as v}from"./index-DlYul3Q_.js";function w({orderKey:o,selectedOrder:r}){const[i,c]=l.useState({}),[x,d]=l.useState(0),[n,p]=l.useState("");l.useEffect(()=>{(async()=>{if(o&&r)c(r.cart||{}),d(m(r.cart||{})),p(r.mobile||"");else{const e=await h.getItem("cart")||{};c(e),d(m(e)),e._orderInfo?.mobile&&p(e._orderInfo.mobile)}})()},[o,r]);const u=async()=>{if(!n){alert("Please enter mobile number before saving");return}let t=o;if(!t)try{t=await g(n)}catch{alert("Invalid mobile number for order key generation");return}const s={cart:i,mobile:n,createdAt:new Date().toISOString()};await j(t,s),console.log("Order saved:",t,s),alert(`âœ… Order saved successfully (${t})`),await v(),c({}),d(0)},f=()=>{if(!n){alert("Please enter mobile number before sending");return}const t=Object.values(i).filter(s=>s&&s.name).map(s=>`${s.name} - â‚¹${s.finalPrice} Ã— ${s.quantity}`).join(`
`),e=`https://wa.me/91${n}?text=${encodeURIComponent(t)}`;console.log("Opening WhatsApp:",e),window.open(e,"_blank")};return a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"ðŸ›’ Your Cart"}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1",children:"Mobile Number:"}),a.jsx("input",{type:"text",value:n,onChange:t=>{const e=t.target.value.replace(/\D/g,"");e.length<=10&&p(e)},placeholder:"10-digit number",className:"border px-2 py-1 rounded w-full"})]}),a.jsx("div",{className:"space-y-2",children:Object.entries(i).filter(([t])=>t!=="_orderInfo"&&t!=="_mobile").map(([t,e])=>a.jsxs("div",{className:"border-b py-2",children:[a.jsx("div",{className:"text-sm space-y-1",children:Object.entries(e).map(([s,b])=>a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("span",{className:"font-semibold",children:[s,":"]}),a.jsx("span",{children:b?.toString()})]},s))}),a.jsxs("div",{className:"text-right mt-1",children:["Qty: ",e.quantity," Ã— â‚¹",e.finalPrice," ="," ",a.jsxs("span",{className:"font-bold",children:["â‚¹",(e.quantity*parseFloat(e.finalPrice)).toFixed(2)]})]})]},t))}),a.jsxs("div",{className:"font-bold",children:["Total: â‚¹",x.toFixed(2)]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"ðŸ’¾ Save Order"}),a.jsx("button",{onClick:f,className:"px-4 py-2 bg-green-600 text-white rounded",children:"ðŸ“² Send via WhatsApp"})]})]})}export{w as default};
