import{r as c,j as e,l as n}from"./index-_yKXn4cI.js";function C({orderKey:l,onSave:u,onModify:j}){const[o,x]=c.useState({}),[p,b]=c.useState(0),[d,m]=c.useState({orderNo:"",createdAt:""});c.useEffect(()=>{(async()=>{const t=await n.getItem("cart")||{};let s=t._mobile;if(!s&&l&&/^\d{10}/.test(l)&&(s=l.split("/")[0],t._mobile=s,await n.setItem("cart",t)),t._orderInfo)m(t._orderInfo);else{const a=await n.getItem("orders")||{},N=Object.keys(a).filter(y=>y.startsWith(s)).length+1,h={orderNo:s?`${s}/${N}`:`ORD-${Date.now()}`,createdAt:new Date().toLocaleString()};t._orderInfo=h,await n.setItem("cart",t),m(h)}x(t);const i=Object.entries(t).filter(([a])=>a!=="_orderInfo"&&a!=="_mobile").reduce((a,[,f])=>a+(parseFloat(f.finalPrice)||0)*(f.quantity||0),0);b(i)})()},[l]);const g=async()=>{window.confirm("Clear all items from the cart?")&&(await n.setItem("cart",{}),x({}),b(0),m({orderNo:"",createdAt:""}),window.dispatchEvent(new Event("cartUpdated")))};return e.jsxs("div",{className:"p-4",children:[d.orderNo&&e.jsxs("div",{className:"mb-3 p-3 bg-gray-100 border rounded",children:[e.jsxs("p",{className:"text-sm font-semibold",children:["ðŸ§¾ Order No: ",d.orderNo]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["ðŸ“… ",d.createdAt]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"ðŸ›’ Cart"}),e.jsx("button",{onClick:g,className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Clear Cart"})]}),Object.keys(o).filter(r=>r!=="_orderInfo"&&r!=="_mobile").length===0?e.jsx("p",{className:"text-gray-500",children:"Cart is empty"}):Object.entries(o).filter(([r])=>r!=="_orderInfo"&&r!=="_mobile").map(([r,t])=>e.jsxs("div",{className:"border-b py-2",children:[e.jsx("div",{className:"mb-1",children:Object.entries(t).map(([s,i])=>{const a=s.toLowerCase();return["code","particulars","description","name"].includes(a)?e.jsx("span",{className:"mr-2 font-semibold",children:a==="code"?`[${i}]`:i},s):null})}),e.jsxs("div",{className:"text-right",children:["Qty: ",t.quantity," Ã— â‚¹",t.finalPrice," ="," ",e.jsxs("span",{className:"font-bold",children:["â‚¹",(t.quantity*parseFloat(t.finalPrice)).toFixed(2)]})]})]},r)),Object.keys(o).filter(r=>r!=="_orderInfo"&&r!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between items-center mt-4 p-2 border-t",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-green-700",children:["â‚¹",p.toFixed(2)]})]}),Object.keys(o).filter(r=>r!=="_orderInfo"&&r!=="_mobile").length>0&&e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("button",{onClick:j,className:"px-3 py-1 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Modify"}),e.jsx("button",{onClick:()=>u(o),className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:"Save Order"})]})]})}export{C as default};
