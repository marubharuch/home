import{l as o,r as d,j as e}from"./index-CyPBQA_H.js";const f=async s=>(await o.getItem("orders")||{})[s]||null,b=async s=>{const n=await o.getItem("orders")||{};n[s]&&(delete n[s],await o.setItem("orders",n))};function g({orderKey:s,onSave:n,onModify:x}){const[l,c]=d.useState({}),[i,h]=d.useState({});d.useEffect(()=>{(async()=>{if(s&&s!=="NEW"){const t=await f(s);t&&(c(t.cart||{}),h({phone:t.mobile,serial:t.serial||s.split("/").pop(),createdAt:t.createdAt||t.updatedAt}))}})()},[s]);const m=(a,t)=>{c(r=>({...r,[a]:{...r[a],quantity:parseFloat(t)||0}}))},p=a=>{c(t=>{const r={...t};return delete r[a],r})},u=async()=>{window.confirm("Delete entire order?")&&(await b(s),x())},j=Object.values(l).reduce((a,t)=>a+(parseFloat(t.finalPrice)||0)*(t.quantity||0),0);return e.jsxs("div",{className:"p-4 bg-white shadow rounded",children:[s?.startsWith("TEMP/")&&e.jsx("div",{className:"mb-3 text-sm text-yellow-700",children:e.jsx("p",{children:"âš ï¸ This is a temporary order. Enter mobile to finalize."})}),s!=="NEW"&&!s?.startsWith("TEMP/")&&e.jsxs("div",{className:"mb-3 text-sm text-gray-600",children:[e.jsxs("p",{children:["ðŸ“ž Phone: ",i.phone]}),e.jsxs("p",{children:["ðŸ†” Order No: ",i.serial]}),e.jsxs("p",{children:["ðŸ“… Date: ",i.createdAt]})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(l).map(([a,t])=>e.jsxs("div",{className:"flex justify-between items-center border p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["â‚¹",t.finalPrice]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:t.quantity||"",onChange:r=>m(a,r.target.value),className:"border w-16 text-center rounded"}),e.jsx("button",{onClick:()=>p(a),className:"bg-red-500 text-white px-2 py-1 rounded",children:"ðŸ—‘ï¸"})]})]},a))}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Total: â‚¹",j.toFixed(2)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(l),className:"bg-green-600 text-white px-3 py-1 rounded",children:"ðŸ’¾ Save"}),s!=="NEW"&&!s?.startsWith("TEMP/")&&e.jsx("button",{onClick:u,className:"bg-red-600 text-white px-3 py-1 rounded",children:"Delete Order"}),e.jsx("button",{onClick:x,className:"bg-gray-400 text-white px-3 py-1 rounded",children:"Back"})]})]})]})}export{g as default};
